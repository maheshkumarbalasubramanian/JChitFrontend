<div class="areas-container">
    <div class="header">
      <h1>Areas</h1>
      <div class="header-actions">
        <button class="btn btn-outline" (click)="navigateToCustomers()">
          <i class="fa fa-users"></i> View Customers
        </button>
        <button class="btn btn-outline" (click)="exportAreas()">
          <i class="fa fa-download"></i> Export
        </button>
      </div>
    </div>
  
    <div class="stats">
      <div class="stat-card">
        <div class="stat-number">{{ stats.total }}</div>
        <div class="stat-label">TOTAL</div>
      </div>
      <div class="stat-card active">
        <div class="stat-number">{{ stats.active }}</div>
        <div class="stat-label">ACTIVE</div>
      </div>
      <div class="stat-card inactive">
        <div class="stat-number">{{ stats.inactive }}</div>
        <div class="stat-label">INACTIVE</div>
      </div>
      <div class="stat-card recent">
        <div class="stat-number">{{ stats.recent }}</div>
        <div class="stat-label">RECENT</div>
      </div>
    </div>
  
    <div class="controls">
      <div class="search-box">
        <i class="fa fa-search"></i>
        <input 
          type="text" 
          placeholder="Search areas..." 
          [(ngModel)]="searchTerm"
          (input)="onSearch()">
      </div>
      <div class="controls-right">
        <button 
          class="btn btn-outline" 
          (click)="toggleFilter()"
          [class.active]="showFilters">
          <i class="fa fa-filter"></i>
        </button>
        <div class="view-toggle">
          <button 
            [class.active]="viewMode === 'grid'"
            (click)="setViewMode('grid')">
            <i class="fa fa-th"></i>
          </button>
          <button 
            [class.active]="viewMode === 'list'"
            (click)="setViewMode('list')">
            <i class="fa fa-list"></i>
          </button>
        </div>
        <button 
          class="btn btn-outline" 
          (click)="refreshData()"
          [disabled]="isLoading">
          <i class="fa fa-sync" [class.fa-spin]="isLoading"></i>
        </button>
        <button 
          class="btn btn-primary" 
          (click)="addNewArea()">
          <i class="fa fa-plus"></i>
        </button>
      </div>
    </div>
  
    <!-- Filters Section -->
    <div class="filters-section" *ngIf="showFilters">
      <div class="filter-row">
        <div class="filter-group">
          <label>Status:</label>
          <select [(ngModel)]="statusFilter" (change)="applyFilters()">
            <option value="">All Status</option>
            <option value="active">Active Only</option>
            <option value="inactive">Inactive Only</option>
          </select>
        </div>
        <div class="filter-group">
          <label>Type:</label>
          <select [(ngModel)]="typeFilter" (change)="applyFilters()">
            <option value="">All Types</option>
            <option value="PRIMARY">Primary</option>
            <option value="SECONDARY">Secondary</option>
            <option value="RURAL">Rural</option>
            <option value="URBAN">Urban</option>
          </select>
        </div>
        <div class="filter-group">
          <label>Customer Count:</label>
          <div class="count-inputs">
            <input 
              type="number" 
              placeholder="Min"
              [(ngModel)]="minCustomers"
              (change)="applyFilters()"
              min="0">
            <span>to</span>
            <input 
              type="number" 
              placeholder="Max"
              [(ngModel)]="maxCustomers"
              (change)="applyFilters()"
              min="0">
          </div>
        </div>
        <button class="btn btn-outline btn-sm" (click)="clearFilters()">
          <i class="fa fa-times"></i> Clear Filters
        </button>
      </div>
    </div>
  
    <div class="list-controls">
      <div class="list-info">
        Showing {{ filteredAreas.length }} of {{ areas.length }} areas
      </div>
      <div class="sort-controls">
        <span>Sort by:</span>
        <select [(ngModel)]="sortBy" (change)="applySorting()">
          <option value="areaName">Area Name</option>
          <option value="areaCode">Area Code</option>
          <option value="areaType">Area Type</option>
          <option value="customerCount">Customer Count</option>
          <option value="createdDate">Date Created</option>
        </select>
        <button 
          class="btn btn-outline sort-direction" 
          (click)="toggleSortDirection()"
          [title]="sortDirection === 'asc' ? 'Sort Ascending' : 'Sort Descending'">
          <i class="fa" [class.fa-arrow-up]="sortDirection === 'asc'" [class.fa-arrow-down]="sortDirection === 'desc'"></i>
        </button>
      </div>
      <div class="select-all">
        <input 
          type="checkbox" 
          id="selectAll"
          [checked]="isAllSelected()"
          [indeterminate]="isSomeSelected()"
          (change)="toggleSelectAll($event)">
        <label for="selectAll">Select All</label>
      </div>
    </div>
  
    <!-- Loading State -->
    <div class="loading-state" *ngIf="isLoading">
      <i class="fa fa-spinner fa-spin"></i>
      <p>Loading areas...</p>
    </div>
  
    <!-- Empty State -->
    <div class="empty-state" *ngIf="!isLoading && filteredAreas.length === 0">
      <i class="fa fa-map-marker-alt"></i>
      <h3>No areas found</h3>
      <p *ngIf="searchTerm || statusFilter || typeFilter || minCustomers || maxCustomers">
        Try adjusting your search criteria or filters
      </p>
      <p *ngIf="!searchTerm && !statusFilter && !typeFilter && !minCustomers && !maxCustomers">
        Create your first area to get started
      </p>
      <button class="btn btn-primary" (click)="addNewArea()">
        <i class="fa fa-plus"></i> Add Area
      </button>
    </div>
  
    <!-- Areas Grid/List -->
    <div 
      class="areas-container-view" 
      [class.grid-view]="viewMode === 'grid'"
      [class.list-view]="viewMode === 'list'"
      *ngIf="!isLoading && filteredAreas.length > 0">
      
      <div 
        *ngFor="let area of filteredAreas; trackBy: trackByAreaId" 
        class="area-card"
        [class.selected]="isSelected(area.id)"
        (click)="selectArea(area)">
        
        <input 
          type="checkbox" 
          class="checkbox"
          [checked]="isSelected(area.id)"
          (click)="$event.stopPropagation()"
          (change)="toggleSelection(area.id, $event)">
        
        <div class="status-badge" [class.active]="area.isActive" [class.inactive]="!area.isActive">
          {{ area.isActive ? 'ACTIVE' : 'INACTIVE' }}
        </div>
        
        <div class="area-avatar" [ngClass]="getAreaAvatarClass(area.areaType)">
          {{ getAreaDisplay(area) }}
        </div>
        
        <div class="area-content">
          <div class="area-name">{{ area.areaName }}</div>
          <div class="area-code">{{ area.areaCode }}</div>
          <div class="area-description" *ngIf="area.description">
            {{ area.description }}
          </div>
        </div>
        
        <div class="area-type-display">
          <div class="type-badge" [ngClass]="area.areaType.toLowerCase()">
            {{ area.areaType }}
          </div>
        </div>
        
        <div class="area-details">
          <div class="area-detail">
            <i class="fa fa-users"></i>
            <span>{{ area.customerCount }} customers in this area</span>
          </div>
          <div class="area-detail" *ngIf="area.pincode">
            <i class="fa fa-map-pin"></i>
            <span>{{ area.pincode }}</span>
          </div>
        </div>
        
        <div class="area-actions" (click)="$event.stopPropagation()">
          <button 
            class="action-btn view" 
            (click)="viewAreaCustomers(area)"
            title="View Customers">
            <i class="fa fa-users"></i>
          </button>
          <button 
            class="action-btn edit" 
            (click)="editArea(area)"
            title="Edit Area">
            <i class="fa fa-edit"></i>
          </button>
          <button 
            class="action-btn delete" 
            (click)="deleteArea(area)"
            title="Delete Area"
            [disabled]="area.customerCount > 0">
            <i class="fa fa-trash"></i>
          </button>
        </div>
      </div>
    </div>
  
    <!-- Bulk Actions -->
    <div class="bulk-actions" *ngIf="selectedAreas.size > 0">
      <div class="bulk-info">
        {{ selectedAreas.size }} area(s) selected
      </div>
      <div class="bulk-buttons">
        <button class="btn btn-outline" (click)="bulkActivate()">
          <i class="fa fa-check"></i> Activate
        </button>
        <button class="btn btn-outline" (click)="bulkDeactivate()">
          <i class="fa fa-times"></i> Deactivate
        </button>
        <button class="btn btn-danger" (click)="bulkDelete()">
          <i class="fa fa-trash"></i> Delete
        </button>
      </div>
    </div>
  
    <!-- Area Templates Modal -->
    <div class="templates-modal" *ngIf="showTemplates" (click)="closeTemplates()">
      <div class="templates-content" (click)="$event.stopPropagation()">
        <div class="templates-header">
          <h3>Common Area Templates</h3>
          <button class="close-btn" (click)="closeTemplates()">
            <i class="fa fa-times"></i>
          </button>
        </div>
        <div class="templates-grid">
          <div class="template-category" *ngFor="let category of areaTemplates">
            <h4>{{ category.categoryName }}</h4>
            <div class="template-items">
              <div 
                *ngFor="let template of category.templates"
                class="template-item"
                (click)="createFromTemplate(template)">
                <div class="template-name">{{ template.name }}</div>
                <div class="template-details">
                  <span class="template-type">{{ template.type }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>